# Cluster Autoscaler Helm Values
# Used by: gitops/argo-apps/platform/cluster-autoscaler.yaml
# Chart: kubernetes/autoscaler (aliased as cluster-autoscaler)

cluster-autoscaler:
  autoDiscovery:
    clusterName: simple-time-service-prod
    enabled: true

  awsRegion: us-east-1

  # Use pre-created ServiceAccount with IAM role annotation from serviceaccounts chart
  # This ServiceAccount is created in kube-system namespace with IRSA annotation
  serviceAccount:
    create: false
    name: cluster-autoscaler-aws-cluster-autoscaler

  # Enable RBAC for cluster-autoscaler
  rbac:
    create: true
    serviceAccount:
      create: false
      name: cluster-autoscaler-aws-cluster-autoscaler

  # Pod configuration
  replicaCount: 1
  
  fullnameOverride: aws-cluster-autoscaler

  # Extra arguments for cluster-autoscaler
  extraArgs:
    scan-interval: 10s
    skip-nodes-with-local-storage: "false"
    skip-nodes-with-system-pods: "false"
    balance-similar-node-groups: "true"
    expander: "priority,least-waste"

  # Enable pod priority to prevent eviction during scaling
  priorityClassName: system-cluster-critical

